# Development Setup Specification

## ADDED Requirements

### Requirement: Node.js Project Configuration
The plugin SHALL include a comprehensive `package.json` that defines all pnpm scripts, dependencies, and project metadata.

#### Scenario: pnpm scripts for development workflow
- **WHEN** developer runs `pnpm [script]`
- **THEN** available scripts include:
  - `build` - Single production build of assets
  - `build:watch` - Watch mode for development builds
  - `lint` - Run all linters (PHP, JS, CSS)
  - `lint:php` - PHPCS check for PHP
  - `lint:php:fix` - Automatic PHP code fixing
  - `lint:js` - ESLint check for JavaScript/TypeScript
  - `lint:js:fix` - Automatic JavaScript formatting
  - `format` - Prettier formatting for CSS, JSON, Markdown

#### Scenario: Essential dependencies defined
- **WHEN** developer runs `pnpm install`
- **THEN** package.json includes devDependencies for:
  - Vite (latest stable)
  - TypeScript compiler
  - ESLint with WordPress plugin
  - Prettier for code formatting
  - PostCSS and autoprefixer for CSS processing
  - WordPress JavaScript packages (@wordpress/api-fetch, @wordpress/data, etc. as optional)

### Requirement: TypeScript Configuration
The plugin SHALL include a `tsconfig.json` that configures TypeScript compilation for browser and WordPress environment.

#### Scenario: TypeScript compiler options
- **WHEN** TypeScript files are processed
- **THEN** tsconfig.json specifies:
  - Target: ES2020 or later for modern browsers
  - Module: ESNext for Vite bundling
  - Lib: ES2020, DOM for browser APIs
  - Strict mode enabled
  - Source maps enabled for debugging
  - Resolution for TypeScript path aliases if needed

#### Scenario: Include/exclude paths
- **WHEN** TypeScript compiler runs
- **THEN** tsconfig.json includes `/src/**/*.ts` and `/src/**/*.tsx` while excluding `/node_modules`, `/assets`, and `/vendor`

### Requirement: Vite Configuration File
The plugin SHALL include a `vite.config.ts` that specifies build inputs, outputs, and optimization behavior.

#### Scenario: Build input configuration
- **WHEN** Vite runs `build` command
- **THEN** vite.config.ts defines entry points:
  - `src/admin/index.ts` → `assets/admin.js`
  - `src/public/index.ts` → `assets/public.js`
  - Corresponding SCSS/CSS files for styles

#### Scenario: Output configuration
- **WHEN** build completes
- **THEN** Vite outputs:
  - JavaScript to `/assets` with `.js` extension
  - CSS to `/assets` with `.css` extension
  - Source maps for debugging
  - Optimized, minified code for production

### Requirement: Configuration Files for Standards
The plugin SHALL include all necessary configuration files for code quality tools.

#### Scenario: .phpcs.xml.dist for PHPCS
- **WHEN** PHPCS runs
- **THEN** .phpcs.xml.dist configures:
  - Standard: WordPress-VIP-Go
  - File patterns to check
  - CWP prefix rules
  - Excluded directories (/vendor, /node_modules, /assets)

#### Scenario: .eslintrc.cjs for ESLint
- **WHEN** ESLint runs
- **THEN** .eslintrc.cjs includes:
  - WordPress plugin preset
  - TypeScript parser and rules
  - Browser and node environments
  - JSX support enabled

#### Scenario: .prettierrc.json for Prettier
- **WHEN** Prettier formats code
- **THEN** .prettierrc.json defines:
  - Print width, tab width, use of tabs
  - Trailing commas, quotes, semicolons
  - Consistent formatting across CSS, JSON, Markdown

#### Scenario: .editorconfig for IDE consistency
- **WHEN** developer opens project in IDE
- **THEN** .editorconfig defines:
  - Indentation (spaces vs tabs)
  - Line endings (LF)
  - Charset (UTF-8)
  - Trim trailing whitespace

### Requirement: Build Output and Asset Management
The plugin SHALL manage built assets separately from source code with clear ignore patterns.

#### Scenario: .gitignore for build artifacts
- **WHEN** developer commits to git
- **THEN** .gitignore includes:
  - `/assets` (generated by build)
  - `/node_modules` (installed dependencies)
  - `/vendor` (Composer packages if added)
  - `.env` files
  - IDE and OS-specific files

#### Scenario: Asset caching strategy
- **WHEN** plugin enqueues scripts and styles
- **THEN** version query parameters use plugin version constant to invalidate browser cache on updates

### Requirement: Documentation for Development Workflow
The plugin SHALL provide clear instructions for setting up and running the development environment.

#### Scenario: Setup instructions in README
- **WHEN** developer reads README.md
- **THEN** instructions include:
  - Prerequisites (Node.js version, pnpm)
  - Installation steps (`pnpm install`)
  - Build steps (`pnpm build` and `pnpm build:watch`)
  - How to activate plugin in WordPress

#### Scenario: Linting and formatting guide
- **WHEN** developer reads contribution guidelines
- **THEN** documentation explains:
  - How to run linters before committing
  - How to fix common violations
  - How to enable IDE integration for auto-fixing

#### Scenario: Folder structure documentation
- **WHEN** developer reviews the project
- **THEN** README or inline comments explain:
  - Purpose of each directory
  - Where to add features
  - How PHP and JavaScript integrate

### Requirement: PHP Dependency Management via Composer
The plugin SHALL include a `composer.json` file for managing PHP development dependencies (PHPCS, WordPress standards).

#### Scenario: Composer configuration
- **WHEN** running `composer install`
- **THEN** composer.json installs:
  - `wp-coding-standards/wpcs` for WordPress VIP-Go standards
  - `squizlabs/php_codesniffer` for PHPCS validation
  - Configuration allows running `pnpm lint:php` without manual Composer setup

#### Scenario: Composer lock file
- **WHEN** dependencies are installed
- **THEN** `composer.lock` is generated (excluded from git in pre-deployment)

### Requirement: Testing Structure & Configuration
The plugin SHALL reserve directory structure and configurations for both PHP (PHPUnit) and JavaScript (Jest) testing, even if tests aren't included in the scaffold.

#### Scenario: Test directory structure
- **WHEN** project is initialized
- **THEN** the following directories exist with configuration templates:
  - `/tests/php` with `phpunit.xml` template
  - `/tests/js` with `jest.config.js` template
  - `.README` in each explaining how to add tests

#### Scenario: PHPUnit configuration template
- **WHEN** developer reads `/tests/php/phpunit.xml`
- **THEN** it includes:
  - Bootstrap configuration pointing to WordPress test utilities
  - Test directory patterns
  - Comments explaining how to set up WordPress test environment

#### Scenario: Jest configuration template
- **WHEN** developer reads `/tests/js/jest.config.js`
- **THEN** it includes:
  - TypeScript support configuration
  - Module resolution for `/src` files
  - Comments for adding test coverage thresholds

### Requirement: Continuous Integration Workflow
The plugin SHALL include a GitHub Actions workflow for automated linting and validation on every push and pull request.

#### Scenario: GitHub Actions workflow file
- **WHEN** developer pushes code to GitHub
- **THEN** `.github/workflows/lint.yml` automatically runs:
  - PHPCS validation
  - ESLint validation
  - Prettier format check
  - TypeScript compilation check

#### Scenario: Workflow job matrix
- **WHEN** workflow runs
- **THEN** it checks against:
  - PHP 7.4+ (WordPress minimum compatible version)
  - Node.js LTS (latest stable)
  - Parallel execution for speed

#### Scenario: Workflow failure reporting
- **WHEN** linting fails
- **THEN** GitHub shows:
  - Detailed error output in pull request checks
  - Links to fix violations or run formatters locally